# 20240115

## Private Service Connectã«ã¤ã„ã¦

TODO: Private Service Connectã‚ˆã‚Šæ·±ã‚ãŸã„

å‚è€ƒ: https://blog.g-gen.co.jp/entry/google-api-private-service-connect-explained

- Private Service Connect ã¨ã¯
  - External IP (Public IP) ã‚’æŒãŸãªã„ VM ã‚„ã‚ªãƒ³ãƒ—ãƒ¬ãƒŸã‚¹ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çµŒç”±ã§ Google Cloud ã® API ç¾¤ã‚„ã€Google Cloud ã§ãƒ›ã‚¹ãƒˆã™ã‚‹ç‹¬è‡ªã‚µãƒ¼ãƒ“ã‚¹ã¸ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿
  - VPC å†…ã« IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¤ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã€ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆçµŒç”±ã§ Google Cloud API ã‚„ç‹¬è‡ªã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹

## Terraformã®Collection Typesã«ã¤ã„ã¦

list: [0]ã‹ã‚‰å§‹ã¾ã‚‹é€£ç¶šã—ãŸæ•´æ•°ã«ã‚ˆã£ã¦è­˜åˆ¥ã•ã‚Œã‚‹ä¸€é€£ã®å€¤ã€‚string,number,boolãªã©ã‚’æŒ‡å®šã§ãã‚‹

`list(string)`ã¯æ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆã‚’è¡¨ã™ã€‚

å‚è€ƒ: https://qiita.com/hikaru_motomiya/items/d773355d3ffa854c7ad3

```
variable "hoge" {
  type        = list(string)
  description = "hoge"
  default     = []
}
```

## Terraformã®Variable Validation

å¤‰æ•°ã«å¯¾ã—ã¦Validationã‚’è¨­å®šã§ãã‚‹ã£ã½ã„ã€‚

```
variable "hoge" {
  type        = list(string)
  description = "(Optional) List of IAM members to roles/run.invoker"
  default     = []

  validation {
    condition = can([
      for member in var.hoge : regex("serviceAccount:.*.iam.gserviceaccount.com", member)
    ])
    error_message = "hoge must be serviceAccount:.*.iam.gserviceaccount.com"
  }
}
```

å‚è€ƒ: (can Function)[https://developer.hashicorp.com/terraform/language/expressions/custom-conditions#can-function]

## Terraformã®foræ–‡ã«ã¤ã„ã¦

å‚è€ƒ: https://zenn.dev/wim/articles/terraform_loop#list%E3%82%92for%E3%81%A7%E5%9B%9E%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B 

```
locals {
  list = [
    "hoge",
    "fuga"
  ]
}

output "output_list" {
  value = [for l in local.list : upper(l)]
}
```

`:` ã®å³ã®éƒ¨åˆ†ãŒå®Ÿéš›ã®å€¤ã‚‰ã—ã„ã€‚
ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§è¨€ã†ã¨ã€foræ–‡ã®ä¸­ã§ã™ã‚‹å‡¦ç†ã¿ãŸã„ãª

## VSCodeã®Vimæ‹¡å¼µã§é•·æŠ¼ã—ã§ã‚«ãƒ¼ã‚½ãƒ«ç§»å‹•ã§ããªã„å ´åˆã®å¯¾å‡¦æ³•

TODO: [ã“ã‚Œ](https://www.engilaboo.com/my-pc-settings/)ã«è¿½è¨˜ã—ãŸã„
TODO: memoã®codespacesã«ã‚‚è¨­å®šã—ãŸã„ã€‚dev container?

https://qiita.com/yokohama/items/0aa40e8239d0f8b5afc3

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦VSCodeã‚’å†èµ·å‹•ã§ç›´ã‚‹ã€‚

```zsh
defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool false
defaults write com.microsoft.VSCodeInsiders ApplePressAndHoldEnabled -bool false
```

## Terraformã®ãƒªã‚½ãƒ¼ã‚¹

`google_cloud_run_service_iam_member`ã«ã¤ã„ã¦ã€‚
Cloud Runã«IAMã®è¨­å®šã‚’ã™ã‚‹ãŸã‚ã®ãƒªã‚½ãƒ¼ã‚¹ã€‚

`roles/run.invoker`ã¯serviceã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã€ãŠã‚ˆã³jobã®å®Ÿè¡Œã¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚’ã™ã‚‹ãŸã‚ã®æ¨©é™ã€‚

è¦ã¯ã€Cloud Runã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ã©ã†ã‹ã‚’æŒ‡å®šã€‚

memberãŒ`allUsers`ã®å ´åˆã¯èª°ã§ã‚‚ï¼ˆGoogleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®æœ‰ç„¡ã«ã‹ã‹ã‚ã‚‰ãšã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’åˆ©ç”¨ã™ã‚‹ã™ã¹ã¦ã®äººãŒï¼‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚

```
resource "google_cloud_run_service_iam_member" "allow_members" {
  for_each = toset(var.auth_members)
  location = var.region
  project  = var.project_id
  service  = google_cloud_run_service.service.name
  role     = "roles/run.invoker"
  member   = each.value
}
```

## ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ»ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã§èƒŒæ™¯è‰²ã‚’è¨­å®šã™ã‚‹æ–¹æ³•

https://xn--t8j3bz04sl3w.xyz/spreadsheet/pulldown-haikei-iro/1232/

## Reactã«ãŠã‘ã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®Tips

å‚è€ƒ: https://zenn.dev/y_okt/articles/20230113_day10

1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çŠ¶æ…‹ã«é–¢ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã¨ãã‚Œä»¥å¤–ã®ã‚³ãƒ¼ãƒ‰ãŒæ··åœ¨ã—ã¦ã„ã‚‹å ´åˆã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çŠ¶æ…‹ã«é–¢ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’åˆ¥ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«åˆ‡ã‚Šå‡ºã™
2. Windowing, List virtualization
- å…¨ä½“ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ä»£ã‚ã‚Šã«ã€è¦‹ãˆã‚‹ç¯„å›²ã®ãƒªã‚¹ãƒˆã ã‘ã‚’ DOM ä¸Šã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã‚ˆã†ã¨ã™ã‚‹æŠ€è¡“

## ã‚‚ã¡ã­ã“ã®ã®ãªã¨ã•ã‚“ã®Qiita

[ã‚‚ã¡ã­ã“ã¯ã‚µãƒ©ãƒªãƒ¼ãƒ‹ãƒ£ãƒ³ğŸˆğŸ’¨ ã®ãªã¨](https://qiita.com/MchinecoNonato)

## 