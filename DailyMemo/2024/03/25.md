## Jest の toBe と toEqual の違い

- number, string の比較ならどちらでも良さそう
- object を比較する場合は、toEqual を使用する

参考: https://qiita.com/shts/items/99c36c4b84c3d63e7f19

## GitHub Actions: gitHub.sha の値について

`pull_request`と`pull_request_target`で`github.sha`の値は異なっている。
トリガーによって値が変化するので注意する。

- GITHUB_SHA の値
  - pull_request
    - GITHUB_REF ブランチ（現在の作業ブランチ）での最後のマージコミット
  - pull_request_target
    - PR ベースブランチの直近のコミット

参考: https://docs.github.com/ja/actions/using-workflows/events-that-trigger-workflows

pull_request_target だとベースブランチの直近のコミットが変化しない限り`github.sha`の値が変更されないので、Deploy Image の値が更新されず、Cloud Run にも新しい revision がデプロイされない場合がある。

公式にも以下のようにあるので、基本的には、image の build を行う場合は`pull_request_target`は使わない方が良さそう。

```
pull request からコードをビルドまたは実行する必要がある場合は、このイベントを使わないでください
```

ただ、`pull_request_target`を使わない方が良いのは、（おそらく）`パブリックな`リポジトリに限る。

公開しているリポジトリの場合、ビルドして実行するようなものの場合、pull_request_target で実行するとリポジトリの管理者以外でも秘匿情報を使って任意コードを実行できるから。

非公開リポジトリの場合は外部の人間いないから正直別にどうでも良さそう。

## as const について

オブジェクトリテラルの末尾に as const を記述すれば、プロパティが `readonly` でリテラルタイプで指定した物と同等の扱いになる。

```ts
const pikachu = {
  name: "pikachu",
  no: 25,
  genre: "mouse pokémon",
  height: 0.4,
  weight: 6.0,
} as const;
```

以下のように代入することができない。

```ts
pikachu.name = "raichu";
// Cannot assign to 'name' because it is a read-only property.
```

参考: https://typescriptbook.jp/reference/values-types-variables/const-assertion

## 負荷試験

基本的には、Akamai 等の CDN 無しで耐えられるスペックにしておく。
アプリ単体でもリクエストを捌けるように。

## GraphQL でのスキーマ削除、変更について

```graphql
Content: Content! @deprecated(reason: "HogeHugaなため非推奨")
```

https://qiita.com/ChaaaBooo/items/19ebdc02f56b64fa1d4a

フロントで使用する際に非推奨であることを伝えることができる。
Apollo Server 等のクライアントツール上でも表示してくれる。

既にフロントで使われていて、いきなり消したら影響が大きい場合に使用する。
